<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta http-equiv="Content-Type"
 content="text/html; charset=windows-1252">
  <meta name="Generator" content="Microsoft Word 11 (filtered)">
  <title>CSE 544 Homework 4</title>
  <style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:CMTT12;
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:Times-Roman;
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:\5B8B\4F53;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	margin-bottom:.0001pt;
	text-align:justify;
	text-indent:26.0pt;
	line-height:20.0pt;
	font-size:12.0pt;
	font-family:"Times New Roman";
	color:black;
	letter-spacing:.5pt;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;}
div.Section1
	{page:Section1;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
  </style>
</head>
<body lang="EN-US">
<div class="Section1">
<p class="MsoNormal" style="text-align: center; text-indent: 0in;"
 align="center"><b><span style="font-size: 24pt;">CSE 544 Homework 4</span></b></p>
<p class="MsoNormal" style="text-indent: 25pt;">&nbsp;</p>
<p class="MsoNormal" style="text-indent: 0in;">Due date:
Wednesday, May 24, 2006, in class.</p>
<p class="MsoNormal" style="text-indent: 25pt;">&nbsp; <b><br>
&nbsp;&nbsp;&nbsp;&nbsp; 1. [20 points]</b> Consider a concurrency
control manager by timestamps. Below are several sequences of events,
including start events, where st<sub>i</sub> &nbsp;&nbsp;&nbsp; means
that transaction T<sub>i</sub> starts and co<sub>i</sub> means T<sub>i</sub>
commits. These sequences represent real time, and the timestamp-based
scheduler will allocate &nbsp;&nbsp;&nbsp; timestamps to transactions
in the order of their starts. In each case below tell what happens with
the last write request.</p>
<ol style="margin-top: 0in;" start="1" type="1">
</ol>
<p class="MsoNormal"
 style="text-align: left; text-indent: 0.25in; line-height: normal;"
 align="left">You have to choose between one of the
following four possible answers:</p>
<p class="MsoNormal"
 style="margin-left: 37.5pt; text-align: left; text-indent: -19.5pt; line-height: normal;"
 align="left">(1)<span
 style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">&nbsp;
</span>the request is <b>accepted</b></p>
<p class="MsoNormal"
 style="margin-left: 37.5pt; text-align: left; text-indent: -19.5pt; line-height: normal;"
 align="left">(2)<span
 style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">&nbsp;
</span>the request is <b>ignored</b></p>
<p class="MsoNormal"
 style="margin-left: 37.5pt; text-align: left; text-indent: -19.5pt; line-height: normal;"
 align="left">(3)<span
 style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">&nbsp;
</span>the transaction is <b>delayed</b></p>
<p class="MsoNormal"
 style="margin-left: 37.5pt; text-align: left; text-indent: -19.5pt; line-height: normal;"
 align="left">(4)<span
 style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">&nbsp;
</span>the transaction is <b>rolled
back</b></p>
<p class="MsoNormal" style="text-align: left; line-height: normal;"
 align="left"><b>&nbsp;</b></p>
<p class="MsoNormal"
 style="margin-left: 0.5in; text-align: left; text-indent: -0.25in; line-height: normal;"
 align="left">a)<span
 style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;
</span>st1; st2; st3;
r1(A); r2(B);r2(C); r3(B); co3; w2(B);w1(C)</p>
<p class="MsoNormal"
 style="margin-left: 0.5in; text-align: left; text-indent: -0.25in; line-height: normal;"
 align="left">b)<span
 style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;
</span>st1; st2; r1(A),
r2(B);w2(A); co2; w1(B)</p>
<p class="MsoNormal"
 style="margin-left: 0.5in; text-align: left; text-indent: -0.25in; line-height: normal;"
 align="left">c)<span
 style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;
</span>st1; st3; st2;
r1(A); r2(B); r3(B);w3(A);w2(B); co3; w1(A)</p>
<p class="MsoNormal"
 style="margin-left: 0.5in; text-align: left; text-indent: -0.25in; line-height: normal;"
 align="left">d)<span
 style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;
</span>st1; r1(A); st2;w2(B);
r2(A);w1(B)</p>
<p class="MsoNormal"
 style="margin-left: 0.25in; text-align: left; text-indent: 0in; line-height: normal;"
 align="left">&nbsp; <b><br>
2. [16 points]</b> Consider three tables R(a,b,f), S(b,c,h), T(c,d,g).</p>
<ol style="margin-top: 0in;" start="2" type="1">
</ol>
<p class="MsoNormal"
 style="margin-left: 0.5in; text-align: left; text-indent: -0.25in;"
 align="left">a)<span
 style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;
</span>Consider the following SQL query:</p>
<p class="MsoNormal" style="text-align: left; text-indent: 0.25in;"
 align="left">Select
R.a, sum(T.d)</p>
<p class="MsoNormal"
 style="margin-left: 0.25in; text-align: left; text-indent: 0in;"
 align="left">From R, S, T</p>
<p class="MsoNormal"
 style="margin-left: 0.25in; text-align: left; text-indent: 0in;"
 align="left">Where R.b = S.b And S.c = T.c And R.f = 5 And T.g = 9</p>
<p class="MsoNormal" style="text-align: left; text-indent: 0.25in;"
 align="left">Group
By<b> </b>R.a</p>
<p class="MsoNormal" style="text-align: left; text-indent: 0.25in;"
 align="left">Having
sum(S.h) &gt; 10</p>
<p class="MsoNormal" style="text-align: left; text-indent: 0.25in;"
 align="left">Draw a
logical plan for the query. You may choose any plan as long as it is
correct
(i.e. no need to worry about efficiency).</p>
<p class="MsoNormal" style="text-align: left; text-indent: 0.25in;"
 align="left">&nbsp;</p>
<p class="MsoNormal"
 style="margin-left: 0.5in; text-align: left; text-indent: -0.25in;"
 align="left">b)<span
 style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;
</span>Write
a SQL query that is equivalent to the logical plan below (some non-IE
browsers may not display the plan correctly. You might need to either
use IE or open the homework Word file).<br>
<br>
</p>
<p class="MsoNormal"
 style="margin-left: 0.25in; text-align: left; text-indent: 0in;"
 align="left"><span
 style="position: absolute; z-index: 5; left: 0px; margin-left: 456px; margin-top: 643px; width: 136px; height: 58px;">
<table cellpadding="0" cellspacing="0">
  <tbody>
    <tr>
      <td
 style="background: white none repeat scroll 0% 50%; -moz-background-clip: initial; -moz-background-origin: initial; -moz-background-inline-policy: initial; vertical-align: top;"
 bgcolor="white" height="58" width="136"><span
 style="position: absolute; left: 0pt; z-index: 5;">
      <table cellpadding="0" cellspacing="0" width="100%">
        <tbody>
          <tr>
            <td>
            <div style="padding: 3.6pt 7.2pt;">
            <p class="MsoNormal" style="text-indent: 0in;"><span
 style="font-size: 20pt;">T(c,d,g)</span></p>
            </div>
            </td>
          </tr>
        </tbody>
      </table>
      </span>&nbsp;</td>
    </tr>
  </tbody>
</table>
</span><span
 style="position: absolute; z-index: 4; left: 0px; margin-left: 264px; margin-top: 643px; width: 124px; height: 58px;">
<table cellpadding="0" cellspacing="0">
  <tbody>
    <tr>
      <td
 style="background: white none repeat scroll 0% 50%; -moz-background-clip: initial; -moz-background-origin: initial; -moz-background-inline-policy: initial; vertical-align: top;"
 bgcolor="white" height="58" width="124"><span
 style="position: absolute; left: 0pt; z-index: 4;">
      <table cellpadding="0" cellspacing="0" width="100%">
        <tbody>
          <tr>
            <td>
            <div style="padding: 3.6pt 7.2pt;">
            <p class="MsoNormal"
 style="text-align: left; text-indent: 0in;" align="left"><span
 style="font-size: 20pt;">S(b,c,h)</span></p>
            </div>
            </td>
          </tr>
        </tbody>
      </table>
      </span>&nbsp;</td>
    </tr>
  </tbody>
</table>
</span><span
 style="position: absolute; z-index: 25; left: 0px; margin-left: 359px; margin-top: 50px; width: 2px; height: 54px;"><img
 src="hw4_files/image001.gif" height="54" width="2"></span><span
 style="position: absolute; z-index: 24; left: 0px; margin-left: 359px; margin-top: 143px; width: 2px; height: 75px;"><img
 src="hw4_files/image002.gif" height="75" width="2"></span><span
 style="position: absolute; z-index: 23; left: 0px; margin-left: 215px; margin-top: 258px; width: 110px; height: 54px;"><img
 src="hw4_files/image003.gif" height="54" width="110"></span><span
 style="position: absolute; z-index: 22; left: 0px; margin-left: 203px; margin-top: 362px; width: 74px; height: 158px;"><img
 src="hw4_files/image004.gif" height="158" width="74"></span><span
 style="position: absolute; z-index: 21; left: 0px; margin-left: 59px; margin-top: 351px; width: 110px; height: 75px;"><img
 src="hw4_files/image005.gif" height="75" width="110"></span><span
 style="position: absolute; z-index: 20; left: 0px; margin-left: 371px; margin-top: 278px; width: 98px; height: 158px;"><img
 src="hw4_files/image006.gif" height="158" width="98"></span><span
 style="position: absolute; z-index: 19; left: 0px; margin-left: 479px; margin-top: 466px; width: 2px; height: 54px;"><img
 src="hw4_files/image001.gif" height="54" width="2"></span><span
 style="position: absolute; z-index: 18; left: 0px; margin-left: 479px; margin-top: 559px; width: 2px; height: 85px;"><img
 src="hw4_files/image007.gif" height="85" width="2"></span><span
 style="position: absolute; z-index: 17; left: 0px; margin-left: 287px; margin-top: 559px; width: 2px; height: 85px;"><img
 src="hw4_files/image007.gif" height="85" width="2"></span><span
 style="position: absolute; z-index: 16; left: 0px; margin-left: 35px; margin-top: 466px; width: 2px; height: 54px;"><img
 src="hw4_files/image001.gif" height="54" width="2"></span><span
 style="position: absolute; z-index: 15; left: 0px; margin-left: 35px; margin-top: 559px; width: 2px; height: 85px;"><img
 src="hw4_files/image007.gif" height="85" width="2"></span><span
 style="position: absolute; z-index: 7; left: 0px; margin-left: 456px; margin-top: 520px; width: 100px; height: 56px;">
<table cellpadding="0" cellspacing="0">
  <tbody>
    <tr>
      <td
 style="background: white none repeat scroll 0% 50%; -moz-background-clip: initial; -moz-background-origin: initial; -moz-background-inline-policy: initial; vertical-align: top;"
 bgcolor="white" height="56" width="100"><span
 style="position: absolute; left: 0pt; z-index: 7;">
      <table cellpadding="0" cellspacing="0" width="100%">
        <tbody>
          <tr>
            <td>
            <div style="padding: 3.6pt 7.2pt;">
            <p class="MsoNormal"
 style="text-align: left; text-indent: 0in;" align="left"><span
 style="font-size: 20pt;">&#8719;</span><sub><span style="font-size: 26pt;">cg</span></sub></p>
            </div>
            </td>
          </tr>
        </tbody>
      </table>
      </span>&nbsp;</td>
    </tr>
  </tbody>
</table>
</span><span
 style="position: absolute; z-index: 6; left: 0px; margin-left: 264px; margin-top: 520px; width: 88px; height: 56px;">
<table cellpadding="0" cellspacing="0">
  <tbody>
    <tr>
      <td
 style="background: white none repeat scroll 0% 50%; -moz-background-clip: initial; -moz-background-origin: initial; -moz-background-inline-policy: initial; vertical-align: top;"
 bgcolor="white" height="56" width="88"><span
 style="position: absolute; left: 0pt; z-index: 6;">
      <table cellpadding="0" cellspacing="0" width="100%">
        <tbody>
          <tr>
            <td>
            <div style="padding: 3.6pt 7.2pt;">
            <p class="MsoNormal"
 style="text-align: left; text-indent: 0in;" align="left"><span
 style="font-size: 20pt;">&#8719;</span><sub><span style="font-size: 26pt;">bc</span></sub></p>
            </div>
            </td>
          </tr>
        </tbody>
      </table>
      </span>&nbsp;</td>
    </tr>
  </tbody>
</table>
</span><span
 style="position: absolute; z-index: 2; left: 0px; margin-left: 24px; margin-top: 519px; width: 112px; height: 57px;">
<table cellpadding="0" cellspacing="0">
  <tbody>
    <tr>
      <td
 style="background: white none repeat scroll 0% 50%; -moz-background-clip: initial; -moz-background-origin: initial; -moz-background-inline-policy: initial; vertical-align: top;"
 bgcolor="white" height="57" width="112"><span
 style="position: absolute; left: 0pt; z-index: 2;">
      <table cellpadding="0" cellspacing="0" width="100%">
        <tbody>
          <tr>
            <td>
            <div style="padding: 3.6pt 7.2pt;">
            <p class="MsoNormal"
 style="text-align: left; text-indent: 0in;" align="left"><span
 style="font-size: 20pt; font-family: Symbol;">s</span><sub><span
 style="font-size: 26pt;">a&gt;5</span></sub></p>
            </div>
            </td>
          </tr>
        </tbody>
      </table>
      </span>&nbsp;</td>
    </tr>
  </tbody>
</table>
</span><span
 style="position: absolute; z-index: 3; left: 0px; margin-left: 24px; margin-top: 643px; width: 112px; height: 58px;">
<table cellpadding="0" cellspacing="0">
  <tbody>
    <tr>
      <td
 style="background: white none repeat scroll 0% 50%; -moz-background-clip: initial; -moz-background-origin: initial; -moz-background-inline-policy: initial; vertical-align: top;"
 bgcolor="white" height="58" width="112"><span
 style="position: absolute; left: 0pt; z-index: 3;">
      <table cellpadding="0" cellspacing="0" width="100%">
        <tbody>
          <tr>
            <td>
            <div style="padding: 3.6pt 7.2pt;">
            <p class="MsoNormal"
 style="text-align: left; text-indent: 0in;" align="left"><span
 style="font-size: 20pt;">R(a,b,f)</span></p>
            </div>
            </td>
          </tr>
        </tbody>
      </table>
      </span>&nbsp;</td>
    </tr>
  </tbody>
</table>
</span><span
 style="position: absolute; z-index: 14; left: 0px; margin-left: 312px; margin-top: 19px; width: 88px; height: 56px;">
<table cellpadding="0" cellspacing="0">
  <tbody>
    <tr>
      <td
 style="background: white none repeat scroll 0% 50%; -moz-background-clip: initial; -moz-background-origin: initial; -moz-background-inline-policy: initial; vertical-align: top;"
 bgcolor="white" height="56" width="88"><span
 style="position: absolute; left: 0pt; z-index: 14;">
      <table cellpadding="0" cellspacing="0" width="100%">
        <tbody>
          <tr>
            <td>
            <div style="padding: 3.6pt 7.2pt;">
            <p class="MsoNormal" style="text-align: left;" align="left"><span
 style="font-size: 20pt; font-family: Symbol;">d</span></p>
            </div>
            </td>
          </tr>
        </tbody>
      </table>
      </span>&nbsp;</td>
    </tr>
  </tbody>
</table>
</span><span
 style="position: absolute; z-index: 13; left: 0px; margin-left: 336px; margin-top: 103px; width: 88px; height: 56px;">
<table cellpadding="0" cellspacing="0">
  <tbody>
    <tr>
      <td
 style="background: white none repeat scroll 0% 50%; -moz-background-clip: initial; -moz-background-origin: initial; -moz-background-inline-policy: initial; vertical-align: top;"
 bgcolor="white" height="56" width="88"><span
 style="position: absolute; left: 0pt; z-index: 13;">
      <table cellpadding="0" cellspacing="0" width="100%">
        <tbody>
          <tr>
            <td>
            <div style="padding: 3.6pt 7.2pt;">
            <p class="MsoNormal"
 style="text-align: left; text-indent: 0in;" align="left"><span
 style="font-size: 20pt;">&#8719;</span><sub><span style="font-size: 26pt;">fg</span></sub></p>
            </div>
            </td>
          </tr>
        </tbody>
      </table>
      </span>&nbsp;</td>
    </tr>
  </tbody>
</table>
</span><span
 style="position: absolute; z-index: 12; left: 0px; margin-left: 347px; margin-top: 225px; width: 26px; height: 25px;"><img
 src="hw4_files/image008.gif" height="25" width="26"></span><span
 style="position: absolute; z-index: 11; left: 0px; margin-left: 372px; margin-top: 238px; width: 88px; height: 35px;">
<table cellpadding="0" cellspacing="0">
  <tbody>
    <tr>
      <td
 style="background: white none repeat scroll 0% 50%; -moz-background-clip: initial; -moz-background-origin: initial; -moz-background-inline-policy: initial; vertical-align: top;"
 bgcolor="white" height="35" width="88"><span
 style="position: absolute; left: 0pt; z-index: 11;">
      <table cellpadding="0" cellspacing="0" width="100%">
        <tbody>
          <tr>
            <td>
            <div style="padding: 3.6pt 7.2pt;">
            <p class="MsoNormal" style="text-indent: 0in;"><span
 style="font-size: 16pt;">S.c=T.c</span></p>
            </div>
            </td>
          </tr>
        </tbody>
      </table>
      </span>&nbsp;</td>
    </tr>
  </tbody>
</table>
</span><span
 style="position: absolute; z-index: 9; left: 0px; margin-left: 204px; margin-top: 331px; width: 88px; height: 36px;">
<table cellpadding="0" cellspacing="0">
  <tbody>
    <tr>
      <td
 style="background: white none repeat scroll 0% 50%; -moz-background-clip: initial; -moz-background-origin: initial; -moz-background-inline-policy: initial; vertical-align: top;"
 bgcolor="white" height="36" width="88"><span
 style="position: absolute; left: 0pt; z-index: 9;">
      <table cellpadding="0" cellspacing="0" width="100%">
        <tbody>
          <tr>
            <td>
            <div style="padding: 3.6pt 7.2pt;">
            <p class="MsoNormal" style="text-indent: 0in;"><span
 style="font-size: 16pt;">R.b=S.b</span></p>
            </div>
            </td>
          </tr>
        </tbody>
      </table>
      </span>&nbsp;</td>
    </tr>
  </tbody>
</table>
</span><span
 style="position: absolute; z-index: 10; left: 0px; margin-left: 179px; margin-top: 319px; width: 26px; height: 25px;"><img
 src="hw4_files/image009.gif" height="25" width="26"></span><span
 style="position: absolute; z-index: 1; left: 0px; margin-left: 24px; margin-top: 425px; width: 124px; height: 56px;">
<table cellpadding="0" cellspacing="0">
  <tbody>
    <tr>
      <td
 style="background: white none repeat scroll 0% 50%; -moz-background-clip: initial; -moz-background-origin: initial; -moz-background-inline-policy: initial; vertical-align: top;"
 bgcolor="white" height="56" width="124"><span
 style="position: absolute; left: 0pt; z-index: 1;">
      <table cellpadding="0" cellspacing="0" width="100%">
        <tbody>
          <tr>
            <td>
            <div style="padding: 3.6pt 7.2pt;">
            <p class="MsoNormal"
 style="text-align: left; text-indent: 0in;" align="left"><span
 style="font-size: 20pt;">&#8719;</span><sub><span style="font-size: 26pt;">bf</span></sub></p>
            </div>
            </td>
          </tr>
        </tbody>
      </table>
      </span>&nbsp;</td>
    </tr>
  </tbody>
</table>
</span><span
 style="position: absolute; z-index: 8; left: 0px; margin-left: 456px; margin-top: 435px; width: 112px; height: 58px;">
<table cellpadding="0" cellspacing="0">
  <tbody>
    <tr>
      <td
 style="background: white none repeat scroll 0% 50%; -moz-background-clip: initial; -moz-background-origin: initial; -moz-background-inline-policy: initial; vertical-align: top;"
 bgcolor="white" height="58" width="112"><span
 style="position: absolute; left: 0pt; z-index: 8;">
      <table cellpadding="0" cellspacing="0" width="100%">
        <tbody>
          <tr>
            <td>
            <div style="padding: 3.6pt 7.2pt;">
            <p class="MsoNormal"
 style="text-align: left; text-indent: 0in;" align="left"><span
 style="font-size: 20pt; font-family: Symbol;">s</span><sub><span
 style="font-size: 26pt;">g&lt;9</span></sub></p>
            </div>
            </td>
          </tr>
        </tbody>
      </table>
      </span>&nbsp;</td>
    </tr>
  </tbody>
</table>
</span><br>
<br>
</p>
<p class="MsoNormal" style="text-indent: 0in;">&nbsp;</p>
<p class="MsoNormal"
 style="margin-left: 0.25in; text-align: left; text-indent: 0in;"
 align="left">&nbsp;</p>
<p class="MsoNormal"
 style="margin-left: 0.25in; text-align: left; text-indent: 0in;"
 align="left">&nbsp;</p>
<p class="MsoNormal"
 style="margin-left: 0.25in; text-align: left; text-indent: 0in; line-height: normal;"
 align="left">&nbsp;</p>
<p class="MsoNormal"
 style="margin-left: 0.25in; text-align: left; text-indent: 0in; line-height: normal;"
 align="left">&nbsp;</p>
<p class="MsoNormal"
 style="margin-left: 0.25in; text-align: left; text-indent: 0in; line-height: normal;"
 align="left">&nbsp;</p>
<p class="MsoNormal" style="text-align: left; line-height: normal;"
 align="left">&nbsp;</p>
<p class="MsoNormal"
 style="text-align: left; text-indent: 0.25in; line-height: normal;"
 align="left">&nbsp;</p>
<p class="MsoNormal" style="margin-left: 0.25in; text-indent: 0in;">&nbsp;</p>
<p class="MsoNormal" style="text-indent: 25pt;">&nbsp;</p>
<p class="MsoNormal" style="text-indent: 25pt;">&nbsp;</p>
<p class="MsoNormal" style="text-indent: 25pt;">&nbsp;</p>
<p class="MsoNormal" style="text-indent: 25pt;">&nbsp;</p>
<p class="MsoNormal" style="text-indent: 25pt;">&nbsp;</p>
<p class="MsoNormal" style="text-indent: 25pt;">&nbsp;</p>
<p class="MsoNormal" style="text-indent: 25pt;">&nbsp;</p>
<p class="MsoNormal" style="text-indent: 25pt;">&nbsp;</p>
<p class="MsoNormal" style="text-indent: 25pt;">&nbsp;</p>
<p class="MsoNormal" style="text-indent: 25pt;">&nbsp;</p>
<p class="MsoNormal" style="text-indent: 25pt;">&nbsp;</p>
<p class="MsoNormal" style="text-indent: 25pt;">&nbsp;</p>
<p class="MsoNormal" style="text-indent: 25pt;">&nbsp;</p>
<p class="MsoNormal" style="text-indent: 25pt;">&nbsp;</p>
<p class="MsoNormal" style="text-indent: 25pt;">&nbsp;</p>
<p class="MsoNormal" style="text-indent: 25pt;">&nbsp;</p>
<p class="MsoNormal" style="text-indent: 25pt;">&nbsp;</p>
<p class="MsoNormal" style="text-indent: 0.5in;"><b>&nbsp;</b></p>
<p class="MsoNormal" style="text-indent: 0.5in;"><b>&nbsp;</b></p>
<p class="MsoNormal" style="text-indent: 0in;"><b>&nbsp;&nbsp;&nbsp; 3.
[16
points]</b> Consider the drinkers, beers, bars schema shown below: </p>
<p class="MsoNormal" style=""><span
 style="color: windowtext; letter-spacing: 0pt;">Likes(drinker, beer);
Frequents(drinker, bar); Serves(bar,
beer)</span></p>
<p class="MsoNormal"
 style="margin-left: 26pt; text-align: left; text-indent: 0in; line-height: normal;"
 align="left"><span style="color: windowtext; letter-spacing: 0pt;">Write
logical plans that compute the following:</span></p>
<p class="MsoNormal" style="text-align: left; line-height: normal;"
 align="left"><span style="color: windowtext; letter-spacing: 0pt;">(a)
All
drinkers that frequent only bars that serve only beer they like.
(Optimists)</span></p>
<p class="MsoNormal" style="text-align: left; line-height: normal;"
 align="left"><span style="color: windowtext; letter-spacing: 0pt;">(b)
All
drinkers that frequent only bars that serve none of the beers they
like.
(Flagellators)</span></p>
<p class="MsoNormal"
 style="text-align: left; text-indent: 0.5in; line-height: normal;"
 align="left"><span
 style="font-family: CMTT12; color: windowtext; letter-spacing: 0pt;">&nbsp;</span></p>
<p class="MsoNormal" style="text-align: left; text-indent: 0in;"
 align="left"><b>&nbsp;&nbsp;&nbsp; 4. [16
points] </b>(Selectivity Estimation) Assume a table R(A,B,C,D) and
consider the
problem of estimating the size of the following query:</p>
<p class="MsoNormal" style="text-align: left; text-indent: 0.25in;"
 align="left">Select
*</p>
<p class="MsoNormal" style="text-align: left; text-indent: 0.25in;"
 align="left">From R</p>
<p class="MsoNormal" style="text-align: left; text-indent: 0.25in;"
 align="left">Where
(R.A= ‘a’ and R.B = ‘b’) and R.C = ‘c’</p>
<p class="MsoNormal"
 style="margin-left: 0.25in; text-align: left; text-indent: 0in;"
 align="left">You are lucky and have lots of statistics on R: you know
its
cardinality and have five histograms: three one dimensional histograms
on R.A,
R.B, R.C and two 2-dimensional histograms on (R.A, R.B) and on (R.B,
R.C) </p>
<p class="MsoNormal" style="text-align: left; text-indent: 0.25in;"
 align="left">|R| = n
(say, 1,000,000)</p>
<p class="MsoNormal" style="text-align: left; text-indent: 0.25in;"
 align="left"># of
tuples that have R.A = ‘a’ is n1</p>
<p class="MsoNormal" style="text-align: left; text-indent: 0.25in;"
 align="left"># of
tuples that have R.B = ‘b’ is n2</p>
<p class="MsoNormal" style="text-align: left; text-indent: 0.25in;"
 align="left"># of
tuples that have R.C = ‘c’ is n3</p>
<p class="MsoNormal" style="text-align: left; text-indent: 0.25in;"
 align="left"># of
tuples that have R.A = ‘a’ and R.B=’b’ is n12</p>
<p class="MsoNormal" style="text-align: left; text-indent: 0.25in;"
 align="left"># of
tuples that have R.B = ‘b’ and R.C=’c’ is n23</p>
<p class="MsoNormal"
 style="margin-left: 0.25in; text-align: left; text-indent: 0in;"
 align="left">Estimate the size of the query Q in terms of the six
numbers
above.&nbsp; You might find it convenient to use the notations p1 =
n1/n, p2 = n2/n,
etc, which represent probabilities rather than tuples, and express the
final
answer as p*n, where p is the expression you need to find. Attributes A
and C are known to be conditionally independent given B.&nbsp; Now,
suppose we modify query Q by replacing the second "and" in the where
clause&nbsp; (next to R.C) with an "or" instead. Repeat the problem for
this modified query.<br>
</p>
<p class="MsoNormal"
 style="margin-left: 0.25in; text-align: left; text-indent: 0in;"
 align="left">&nbsp;</p>
<p class="MsoNormal" style="text-align: left; text-indent: 0in;"
 align="left"><b>&nbsp;&nbsp;&nbsp; 5. [32
points]&nbsp; </b>We have n+1 relations, with the following schemas:</p>
<p class="MsoNormal"
 style="margin-left: 0.5in; text-align: left; text-indent: 0in;"
 align="left"><span style="font-size: 14pt;">S(C<sub>1</sub>,C<sub>2</sub>,...,
C<sub>n</sub>), R<sub>1</sub>(A<sub>1</sub>,B<sub>1</sub>),...,&nbsp; R<sub>n</sub>(A<sub>n</sub>,B<sub>n</sub>)<br>
</span>Consider two join expressions:</p>
<p class="MsoNormal" style="text-align: left; text-indent: 0.5in;"
 align="left"><span style="font-size: 14pt;">E = R<sub>1</sub>&nbsp;
Join<sub>B1=A2</sub>&nbsp; R<sub>2</sub>
Join<sub>B2=A3</sub>&nbsp; . . . R<sub>n-1</sub> Join<sub>Bn-1=An</sub>&nbsp;&nbsp;
R<sub>n</sub></span></p>
<p class="MsoNormal" style="text-align: left; text-indent: 0.5in;"
 align="left"><span style="font-size: 14pt;">F = S&nbsp; Join<sub>C1</sub><sub>=A1</sub>&nbsp;
R<sub>1</sub>
Join<sub>C2=A2</sub>&nbsp; R<sub>2</sub> . . .&nbsp; R<sub>n-1</sub>
Join<sub>Cn=An</sub>&nbsp;
R<sub>n</sub></span></p>
<p class="MsoNormal"
 style="margin-left: 18.75pt; text-align: left; text-indent: 0in;"
 align="left">E is a chain join, and F is a star join. Assume that we
restrict the joins plans only to join trees without cartesian products.
We
distinguish between a plan A Join B&nbsp;&nbsp; and a plan B Join
A.&nbsp; Compute how
many plans exist for E and for F, and how many subplans will be
inspected by
the dynamic programming algorithm. Assume only left-linear join trees
are allowed.
Your answer should consist of four functions in n.</p>
</div>
</body>
</html>
